import{r as l,j as e,H as K}from"./app-k1GojqXu.js";import{H as $}from"./HostLayout-2SJjhaLX.js";import{A as q,S as z}from"./AttachFile-DtGGpWVB.js";import{V as G}from"./VideoFile-BX9KVjYw.js";import{M as Q}from"./MoreVert-CLMba-2y.js";import{A as X}from"./Add-HpS-V_oC.js";import{C as Z}from"./Close-Ba8cFB5d.js";import{R as ee,C as L}from"./Row-BGspGPYI.js";import{C as D,a as N}from"./CardContent-DBiktHXJ.js";import{B as b,S as a,M as te,P as se}from"./Stack-CYseCBxy.js";import{B as o,T as n}from"./Box-D4yAPD6z.js";import{A,I as F,M as E}from"./KeyboardArrowDown-CQnTADGU.js";import{T as re}from"./TextField-CFKFQx2k.js";import{D as oe,a as ie,b as ne,c as ae}from"./DialogTitle-C2l68Ksu.js";/* empty css            */import"./Logout-D6ncuuCu.js";import"./Hotel-w8LsJmGb.js";import"./Message-aHG1EXTA.js";import"./Container-DsV2d6KA.js";import"./useFormControl-CHHJCYs2.js";function Se(){const S=l.useRef(null),f=l.useRef(null),[h,y]=l.useState(null),[x,M]=l.useState(""),[m,w]=l.useState([]),[T,B]=l.useState({}),[P,p]=l.useState(!1),[u,g]=l.useState(null),[R]=l.useState([{id:1,name:"John Doe",email:"john.doe@example.com",avatar:""},{id:2,name:"Jane Smith",email:"jane.smith@example.com",avatar:""},{id:3,name:"Mike Johnson",email:"mike.johnson@example.com",avatar:""},{id:4,name:"Emily Davis",email:"emily.davis@example.com",avatar:""},{id:5,name:"Robert Wilson",email:"robert.wilson@example.com",avatar:""}]),[C,v]=l.useState([{id:1,customerName:"John Doe",customerAvatar:"",property:"Luxury Beachfront Villa",lastMessage:"hey ðŸ‘‹ hey...",lastMessageTime:new Date("2025-01-20T09:10:00"),unreadCount:1,messages:[{id:1,text:"Hello! I have a question about the property.",sender:"customer",timestamp:new Date("2025-01-20T09:00:00"),read:!0},{id:2,text:"Hi! I'd be happy to help. What would you like to know?",sender:"host",timestamp:new Date("2025-01-20T09:05:00"),read:!0},{id:3,text:"Is the property pet-friendly?",sender:"customer",timestamp:new Date("2025-01-20T09:10:00"),read:!1}]},{id:2,customerName:"Jane Smith",customerAvatar:"",property:"Modern Downtown Apartment",lastMessage:"hey",lastMessageTime:new Date("2025-01-19T14:00:00"),unreadCount:0,messages:[{id:1,text:"What time is check-in?",sender:"customer",timestamp:new Date("2025-01-19T14:00:00"),read:!0},{id:2,text:"The check-in time is flexible.",sender:"host",timestamp:new Date("2025-01-19T14:20:00"),read:!0},{id:3,text:"hey",sender:"customer",timestamp:new Date("2025-01-19T14:25:00"),read:!0}]},{id:3,customerName:"Mike Johnson",customerAvatar:"",property:"Cozy Mountain Cabin",lastMessage:"ðŸ“Ž image",lastMessageTime:new Date("2025-01-18T16:30:00"),unreadCount:0,messages:[{id:1,sender:"customer",timestamp:new Date("2025-01-18T16:30:00"),read:!0,files:[{id:"1",type:"image",url:"/images/popular-stay-1.svg",name:"property-image.jpg",size:245e3}]},{id:2,text:"Looking forward to hosting you!",sender:"host",timestamp:new Date("2025-01-18T16:45:00"),read:!0}]}]),d=C.find(t=>t.id===h),U=()=>{S.current?.scrollIntoView({behavior:"smooth"})};l.useEffect(()=>{d&&U()},[d?.messages]);const J=t=>{if(t.target.files){const r=Array.from(t.target.files);w(i=>[...i,...r])}},O=t=>{w(r=>r.filter((i,s)=>s!==t))},k=()=>{if(!x.trim()&&m.length===0||!h)return;const t=m.map((s,c)=>({id:`file-${Date.now()}-${c}`,type:s.type.startsWith("image/")?"image":"video",url:URL.createObjectURL(s),name:s.name,size:s.size})),r={id:Date.now(),text:x.trim()||void 0,sender:"host",timestamp:new Date,read:!1,files:t.length>0?t:void 0};let i=x.trim()||"";m.length>0&&!x.trim()&&(i=""),v(s=>s.map(c=>c.id===h?{...c,messages:[...c.messages,r],lastMessage:i,lastMessageTime:new Date}:c)),M(""),w([]),f.current&&(f.current.value="")},V=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),k())},I=t=>t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),W=t=>{const r=new Date,i=new Date(r);return i.setDate(i.getDate()-1),t.toDateString()===r.toDateString()?"Today":t.toDateString()===i.toDateString()?"Yesterday":t.toLocaleDateString("en-US",{month:"short",day:"numeric"})},Y=(t,r)=>{B(i=>({...i,[t]:r.currentTarget}))},j=t=>{B(r=>({...r,[t]:null}))},_=t=>{const r=R.find(i=>i.id===t);if(r){const i=C.find(s=>s.customerName===r.name);if(i)y(i.id);else{const s={id:Date.now(),customerName:r.name,customerAvatar:r.avatar,property:"New Property",lastMessage:"",lastMessageTime:new Date,unreadCount:0,messages:[]};v(c=>[s,...c]),y(s.id)}}p(!1),g(null)},H=t=>t.lastMessage.includes("image")||t.lastMessage.includes("video")?"":t.lastMessage;return e.jsxs(e.Fragment,{children:[e.jsx(K,{title:"Messages"}),e.jsxs($,{title:"Messages",children:[e.jsxs(ee,{children:[e.jsx(L,{xs:12,md:4,lg:3,children:e.jsxs(D,{elevation:0,sx:{border:"1px solid #E5E7EB",borderRadius:2,height:"calc(100vh - 200px)",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsx(N,{sx:{p:2},children:e.jsx(b,{variant:"contained",startIcon:e.jsx(X,{}),fullWidth:!0,onClick:()=>p(!0),sx:{bgcolor:"#AD542D",textTransform:"none",fontWeight:700,borderRadius:2,mb:2,py:1.5,"&:hover":{bgcolor:"#78381C"}},children:"Start Conversation"})}),e.jsx(N,{sx:{p:0,flex:1,overflowY:"auto"},children:C.map(t=>e.jsx(o,{onClick:()=>{y(t.id),v(r=>r.map(i=>i.id===t.id?{...i,unreadCount:0,messages:i.messages.map(s=>({...s,read:!0}))}:i))},sx:{p:2,borderBottom:"1px solid #E5E7EB",cursor:"pointer",bgcolor:h===t.id?"#FFF5F7":"transparent",position:"relative","&:hover":{bgcolor:h===t.id?"#FFF5F7":"#F9FAFB"}},children:e.jsxs(a,{direction:"row",spacing:2,alignItems:"flex-start",children:[e.jsx(A,{sx:{bgcolor:"#AD542D",width:48,height:48},children:t.customerName.charAt(0)}),e.jsxs(o,{sx:{flex:1,minWidth:0},children:[e.jsxs(a,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:.5},children:[e.jsx(n,{variant:"subtitle2",sx:{fontWeight:700,color:"#222222"},children:t.customerName}),e.jsxs(a,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(n,{variant:"caption",sx:{color:"#9CA3AF"},children:W(t.lastMessageTime)}),e.jsx(F,{size:"small",onClick:r=>{r.stopPropagation(),Y(t.id,r)},sx:{p:.5},children:e.jsx(Q,{sx:{fontSize:18,color:"#9CA3AF"}})}),e.jsxs(te,{anchorEl:T[t.id],open:!!T[t.id],onClose:()=>j(t.id),children:[e.jsx(E,{onClick:()=>j(t.id),children:"Archive"}),e.jsx(E,{onClick:()=>j(t.id),children:"Delete"}),e.jsx(E,{onClick:()=>j(t.id),children:"Mute"})]})]})]}),e.jsxs(a,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[H(t)&&e.jsx(n,{variant:"body2",sx:{color:t.unreadCount>0?"#222222":"#717171",fontWeight:t.unreadCount>0?600:400,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,mr:1},children:H(t)}),t.unreadCount>0&&e.jsx(o,{sx:{bgcolor:"#AD542D",color:"#FFFFFF",borderRadius:"50%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:700},children:t.unreadCount})]})]})]})},t.id))})]})}),e.jsx(L,{xs:12,md:8,lg:9,children:d?e.jsxs(D,{elevation:0,sx:{border:"1px solid #E5E7EB",borderRadius:2,height:"calc(100vh - 200px)",display:"flex",flexDirection:"column"},children:[e.jsx(o,{sx:{p:2,borderBottom:"1px solid #E5E7EB"},children:e.jsx(a,{direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",children:e.jsxs(a,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(A,{sx:{bgcolor:"#AD542D",width:40,height:40},children:d.customerName.charAt(0)}),e.jsxs(o,{children:[e.jsx(n,{variant:"subtitle1",sx:{fontWeight:700,color:"#222222"},children:d.customerName}),e.jsx(n,{variant:"caption",sx:{color:"#717171"},children:d.property})]})]})})}),e.jsxs(o,{sx:{flex:1,overflowY:"auto",p:2,bgcolor:"#F9FAFB"},children:[d.messages.map((t,r)=>{const i=r===0||new Date(t.timestamp).toDateString()!==new Date(d.messages[r-1].timestamp).toDateString();return e.jsxs(o,{children:[i&&e.jsx(o,{sx:{textAlign:"center",my:2},children:e.jsx(n,{variant:"caption",sx:{color:"#9CA3AF",bgcolor:"#F9FAFB",px:2,py:.5,borderRadius:1},children:W(t.timestamp)})}),e.jsx(a,{direction:"row",justifyContent:t.sender==="host"?"flex-end":"flex-start",sx:{mb:1.5},children:t.files&&t.files.length>0&&!t.text?e.jsxs(o,{sx:{maxWidth:"70%",position:"relative"},children:[e.jsx(a,{spacing:1,children:t.files.map(s=>e.jsx(o,{sx:{position:"relative"},children:s.type==="image"?e.jsx(o,{component:"img",src:s.url,alt:s.name,sx:{maxWidth:"100%",maxHeight:300,borderRadius:2,objectFit:"cover",cursor:"pointer",display:"block"},onClick:()=>window.open(s.url,"_blank")}):e.jsx(o,{sx:{borderRadius:2,overflow:"hidden",maxHeight:300},children:e.jsx("video",{src:s.url,style:{maxWidth:"100%",maxHeight:300,display:"block"},controls:!0})})},s.id))}),e.jsx(n,{variant:"caption",sx:{color:"#9CA3AF",fontSize:"0.7rem",display:"block",mt:.5,textAlign:t.sender==="host"?"right":"left"},children:I(t.timestamp)})]}):e.jsxs(se,{elevation:0,sx:{p:1.5,maxWidth:"70%",bgcolor:t.sender==="host"?"#AD542D":"#FFFFFF",color:t.sender==="host"?"#FFFFFF":"#222222",borderRadius:2,border:t.sender==="customer"?"1px solid #E5E7EB":"none"},children:[t.files&&t.files.length>0&&e.jsx(a,{spacing:1,sx:{mb:t.text?1:0},children:t.files.map(s=>e.jsx(o,{children:s.type==="image"?e.jsx(o,{component:"img",src:s.url,alt:s.name,sx:{maxWidth:"100%",maxHeight:300,borderRadius:1,objectFit:"cover",cursor:"pointer"},onClick:()=>window.open(s.url,"_blank")}):e.jsx(o,{sx:{position:"relative",bgcolor:"rgba(0,0,0,0.5)",borderRadius:1,overflow:"hidden",minHeight:200,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("video",{src:s.url,style:{maxWidth:"100%",maxHeight:300,borderRadius:4},controls:!0})})},s.id))}),t.text&&e.jsx(n,{variant:"body2",sx:{mb:.5},children:t.text}),e.jsx(n,{variant:"caption",sx:{color:t.sender==="host"?"rgba(255,255,255,0.7)":"#9CA3AF",fontSize:"0.7rem"},children:I(t.timestamp)})]})})]},t.id)}),e.jsx("div",{ref:S})]}),m.length>0&&e.jsx(o,{sx:{p:2,borderTop:"1px solid #E5E7EB",bgcolor:"#FFFFFF"},children:e.jsx(a,{direction:"row",spacing:1,sx:{flexWrap:"wrap",gap:1},children:m.map((t,r)=>e.jsxs(o,{sx:{position:"relative",border:"1px solid #E5E7EB",borderRadius:1,overflow:"hidden",width:80,height:80},children:[t.type.startsWith("image/")?e.jsx(o,{component:"img",src:URL.createObjectURL(t),alt:t.name,sx:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(o,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"#F9FAFB"},children:e.jsx(G,{sx:{fontSize:32,color:"#717171"}})}),e.jsx(F,{size:"small",onClick:()=>O(r),sx:{position:"absolute",top:4,right:4,bgcolor:"rgba(0,0,0,0.5)",color:"#FFFFFF",width:20,height:20,"&:hover":{bgcolor:"rgba(0,0,0,0.7)"}},children:"Ã—"})]},r))})}),e.jsx(o,{sx:{p:2,borderTop:"1px solid #E5E7EB"},children:e.jsxs(a,{direction:"row",spacing:1,alignItems:"flex-end",children:[e.jsx("input",{type:"file",ref:f,onChange:J,accept:"image/*,video/*",multiple:!0,style:{display:"none"}}),e.jsx(F,{onClick:()=>f.current?.click(),sx:{border:"1px solid #E5E7EB",borderRadius:2,width:40,height:40,color:"#717171","&:hover":{bgcolor:"#F9FAFB",borderColor:"#AD542D"}},children:e.jsx(q,{})}),e.jsx(re,{fullWidth:!0,placeholder:"Type a message...",value:x,onChange:t=>M(t.target.value),onKeyPress:V,multiline:!0,maxRows:4,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"#FFFFFF","& fieldset":{borderColor:"#E5E7EB"}}}}),e.jsx(b,{variant:"contained",onClick:k,disabled:!x.trim()&&m.length===0,sx:{bgcolor:"#AD542D",borderRadius:2,minWidth:48,height:40,"&:hover":{bgcolor:"#78381C"},"&:disabled":{bgcolor:"#E5E7EB",color:"#9CA3AF"}},children:e.jsx(z,{})})]})})]}):e.jsx(D,{elevation:0,sx:{border:"1px solid #E5E7EB",borderRadius:2,height:"calc(100vh - 200px)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(o,{sx:{textAlign:"center"},children:[e.jsx(o,{sx:{width:80,height:80,borderRadius:"50%",border:"2px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2},children:e.jsx(z,{sx:{fontSize:40,color:"#9CA3AF"}})}),e.jsx(n,{variant:"h6",sx:{color:"#6B7280",mb:1},children:"Select a conversation"}),e.jsx(n,{variant:"body2",sx:{color:"#9CA3AF"},children:"Choose a conversation from the list to start messaging, or create a new one."})]})})})]}),e.jsxs(oe,{open:P,onClose:()=>{p(!1),g(null)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2,maxHeight:"80vh"}},children:[e.jsxs(ie,{sx:{pb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(n,{variant:"h6",sx:{fontWeight:700,color:"#222222"},children:"Start Conversation"}),e.jsx(F,{onClick:()=>{p(!1),g(null)},sx:{color:"#717171"},children:e.jsx(Z,{})})]}),e.jsxs(ne,{sx:{p:0},children:[e.jsx(n,{variant:"body2",sx:{px:3,pb:2,color:"#717171"},children:"Select Participants"}),e.jsx(o,{sx:{maxHeight:"50vh",overflowY:"auto"},children:R.map(t=>e.jsx(o,{onClick:()=>g(t.id),sx:{px:3,py:2,cursor:"pointer",bgcolor:u===t.id?"#FFF5F7":"transparent",borderBottom:"1px solid #E5E7EB","&:hover":{bgcolor:u===t.id?"#FFF5F7":"#F9FAFB"}},children:e.jsxs(a,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(A,{sx:{bgcolor:"#AD542D",width:40,height:40},children:t.name.charAt(0)}),e.jsxs(o,{sx:{flex:1},children:[e.jsx(n,{variant:"subtitle2",sx:{fontWeight:700,color:"#222222",mb:.5},children:t.name}),e.jsx(n,{variant:"body2",sx:{color:"#717171",fontSize:"0.875rem"},children:t.email})]})]})},t.id))})]}),e.jsxs(ae,{sx:{p:2,borderTop:"1px solid #E5E7EB"},children:[e.jsx(b,{onClick:()=>{p(!1),g(null)},sx:{color:"#717171",textTransform:"none",fontWeight:600},children:"Cancel"}),e.jsx(b,{onClick:()=>u&&_(u),disabled:!u,variant:"contained",sx:{bgcolor:"#AD542D",textTransform:"none",fontWeight:700,borderRadius:2,px:3,"&:hover":{bgcolor:"#78381C"},"&:disabled":{bgcolor:"#E5E7EB",color:"#9CA3AF"}},children:"Start"})]})]})]})]})}export{Se as default};
