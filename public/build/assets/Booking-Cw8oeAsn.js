import{c as q,b as M,r as d,j as e,H as A,a as z}from"./app-kf1cIShR.js";import{N as G,F as R}from"./Footer-CMCR6c7C.js";import{T as O}from"./Toast-B106qpbU.js";import{L as H,B as $}from"./BookingSummaryCard-CnzVztvE.js";import{u as U,B as i,T as a}from"./use-language-C8T1lNpe.js";import{f as C}from"./currency-DKMrUsgB.js";import{C as J}from"./Container-DHhHaL4P.js";import{R as K,C as P}from"./Row-Cb5poqVh.js";import{P as W,S as b,a as j,B as Q}from"./ArrowDropDown-DWMWMKcd.js";import{T as p,F as f,S as k}from"./TextField-DiIfVKtJ.js";/* empty css            */import"./Menu-CN5VpIUh.js";import"./Close-DamT0U9D.js";import"./Message-DB_7vqpa.js";import"./Snackbar-BJYmN2iT.js";import"./LocationOn-zbXDu9yo.js";import"./Star-G31TvJJ9.js";import"./CheckCircle-C_jpc__3.js";const V="/images/popular-stay-1.svg";function ge(){const{t}=U(),{currency:v}=q(),{property:o,nights:_,checkin:h,checkout:g,costs:T,totalAmount:S,rules:B}=M().props,w=(s,n)=>{const c={};o?.id&&(c.property_id=String(o.id)),c.checkin=s,c.checkout=n;const u=`/booking?${new URLSearchParams(c).toString()}`;z.visit(u,{method:"get",preserveState:!0,only:["costs","totalAmount","nights","checkin","checkout"]})},[r,D]=d.useState({name:"",email:"",phone:"",phoneCode:"+31",guests:1,rooms:1,adults:1,children:0});d.useEffect(()=>{o&&D(s=>({...s,rooms:Math.max(1,o.bedrooms||1),guests:Math.max(1,o.guests||1),adults:Math.max(1,o.guests?Math.min(o.guests,10):1),children:0}))},[o]);const[l,y]=d.useState({}),[x,N]=d.useState({open:!1,message:"",severity:"success"}),L=()=>{const s={};return r.name.trim()?r.name.trim().length<2&&(s.name=t("booking.err_name_min")):s.name=t("booking.err_name_required"),r.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)||(s.email=t("booking.err_email_invalid")):s.email=t("booking.err_email_required"),r.phone.trim()?/^\d{7,15}$/.test(r.phone.replace(/[\s\-\(\)]/g,""))||(s.phone=t("booking.err_phone_invalid")):s.phone=t("booking.err_phone_required"),y(s),Object.keys(s).length===0},m=(s,n)=>{D({...r,[s]:n}),l[s]&&y({...l,[s]:""})},[E,F]=d.useState(!1),I=s=>{if(s.preventDefault(),!L()){N({open:!0,message:t("booking.toast_fix_errors"),severity:"error"});return}if(!o?.id){N({open:!0,message:t("booking.select_property"),severity:"error"});return}F(!0),z.post("/booking",{property_id:o.id,checkin:h,checkout:g,name:r.name.trim(),email:r.email.trim(),phone_code:r.phoneCode||"+31",phone:r.phone.trim(),rooms:r.rooms??1,adults:r.adults??1,children:r.children??0},{onFinish:()=>F(!1),onError:n=>y(n)})};return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:t("booking.title")}),e.jsxs(i,{children:[e.jsx(G,{}),e.jsx(i,{className:"booking-page",children:e.jsxs(J,{className:"px-0",children:[e.jsx(i,{sx:{mb:2,mt:4},children:e.jsx(a,{variant:"h2",sx:{fontSize:{xs:"1.5rem",sm:"2rem",md:"2.5rem"},fontWeight:800,color:"#222222",mb:2},children:t("booking.title")})}),e.jsxs(K,{children:[e.jsx(P,{xs:12,md:7,lg:8,className:"px-0",children:e.jsxs(W,{elevation:0,className:"booking-form",children:[e.jsx(a,{className:"section-title",sx:{fontSize:{xs:"1.125rem",sm:"1.5rem"},fontWeight:700,color:"#222222",mb:2},children:t("booking.guest_details")}),e.jsxs("form",{onSubmit:I,children:[o&&e.jsxs(b,{direction:"row",spacing:1.5,useFlexGap:!0,className:"field",sx:{mb:2},children:[e.jsxs(i,{sx:{flex:1},children:[e.jsx(a,{className:"label",children:t("home.checkin")}),e.jsx(p,{size:"small",fullWidth:!0,type:"date",value:h,onChange:s=>{const n=s.target.value;let c=g;if(new Date(n)>=new Date(g)){const u=new Date(n);u.setDate(u.getDate()+1),c=u.toISOString().slice(0,10)}w(n,c)},InputLabelProps:{shrink:!0},inputProps:{min:new Date().toISOString().slice(0,10)}})]}),e.jsxs(i,{sx:{flex:1},children:[e.jsx(a,{className:"label",children:t("home.checkout")}),e.jsx(p,{size:"small",fullWidth:!0,type:"date",value:g,onChange:s=>{const n=s.target.value;new Date(n)<=new Date(h)||w(h,n)},InputLabelProps:{shrink:!0},inputProps:{min:h}})]})]}),o&&e.jsx(a,{variant:"body2",sx:{color:"#6B7280",mb:2},children:_!==1?t("booking.nights_note_plural").replace(":count",String(_)):t("booking.nights_note").replace(":count",String(_))}),e.jsxs(i,{className:"field",children:[e.jsx(a,{className:"label",children:t("booking.name")}),e.jsx(p,{size:"small",fullWidth:!0,value:r.name,onChange:s=>m("name",s.target.value),required:!0,error:!!l.name,helperText:l.name})]}),e.jsxs(i,{className:"field",children:[e.jsx(a,{className:"label",children:t("booking.number_of_rooms")}),e.jsx(f,{fullWidth:!0,size:"small",children:e.jsx(k,{value:r.rooms,displayEmpty:!0,onChange:s=>m("rooms",Number(s.target.value)),children:[1,2,3,4,5,6,7,8,9,10].map(s=>e.jsxs(j,{value:s,children:[s," ",s>1?t("booking.rooms"):t("booking.room")]},s))})})]}),e.jsxs(b,{direction:"row",spacing:1.5,useFlexGap:!0,className:"field",children:[e.jsxs(i,{sx:{flex:1},children:[e.jsx(a,{className:"label",children:t("booking.adults")}),e.jsx(f,{fullWidth:!0,size:"small",children:e.jsx(k,{value:r.adults,displayEmpty:!0,onChange:s=>m("adults",Number(s.target.value)),children:[1,2,3,4,5,6,7,8,9,10].map(s=>e.jsxs(j,{value:s,children:[s," ",s>1?t("booking.adults"):t("booking.adult")]},s))})})]}),e.jsxs(i,{sx:{flex:1},children:[e.jsx(a,{className:"label",children:t("booking.children")}),e.jsx(f,{fullWidth:!0,size:"small",children:e.jsx(k,{value:r.children,displayEmpty:!0,onChange:s=>m("children",Number(s.target.value)),children:[0,1,2,3,4,5,6,7,8,9,10].map(s=>e.jsxs(j,{value:s,children:[s," ",t(s===1?"booking.child":"booking.children")]},s))})})]})]}),e.jsxs(i,{className:"field",children:[e.jsx(a,{className:"label",children:t("booking.email")}),e.jsx(p,{size:"small",placeholder:t("booking.email_placeholder"),fullWidth:!0,type:"email",value:r.email,onChange:s=>m("email",s.target.value),required:!0,error:!!l.email,helperText:l.email})]}),e.jsxs(i,{className:"field",children:[e.jsx(a,{className:"label",children:t("booking.phone_number")}),e.jsxs(b,{direction:"row",spacing:1.5,useFlexGap:!0,children:[e.jsx(f,{size:"small",sx:{minWidth:120},children:e.jsx(k,{value:r.phoneCode,onChange:s=>m("phoneCode",s.target.value),children:["+31","+44","+1","+92"].map(s=>e.jsx(j,{value:s,children:s},s))})}),e.jsx(p,{size:"small",fullWidth:!0,value:r.phone,onChange:s=>m("phone",s.target.value),error:!!l.phone,helperText:l.phone})]}),e.jsx(a,{className:"help",children:t("booking.phone_note")})]}),e.jsxs(W,{elevation:0,className:"booking-total",children:[e.jsx(a,{children:t("booking.total")}),e.jsxs(b,{direction:"row",spacing:2,useFlexGap:!0,alignItems:"center",children:[e.jsx(a,{className:"grand-total",children:C(S,v)}),e.jsx(Q,{type:"submit",variant:"contained",className:"request-btn",disabled:E,children:E?"...":t("booking.book_btn")})]})]})]})]})}),e.jsxs(P,{xs:12,md:5,lg:4,children:[e.jsx(H,{image:o?.image??V,title:o?.title??t("booking.select_property"),location:o?.location??"â€”",reviews:o?.reviews_count??0,rating:o?.rating??0}),e.jsx($,{rules:B,costs:T.map(s=>({label:s.label,amount:C(s.amount,v)})),totalAmount:C(S,v)})]})]})]})}),e.jsx(R,{}),e.jsx(O,{open:x.open,onClose:()=>N({...x,open:!1}),message:x.message,severity:x.severity})]})]})}export{ge as default};
