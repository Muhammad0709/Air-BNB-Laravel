import{j as e,c as A,b as M,r as p,H as B,a as W}from"./app-UOOPPRb9.js";import{N as G,F as H}from"./Footer-CUm7w2oZ.js";import{T as $}from"./Toast-BhHH1G_8.js";import{c as R,P as T,S as x,a as f,B as O}from"./ArrowDropDown-DdBapB5l.js";import{L as V,B as U}from"./BookingSummaryCard-CtjaKMaY.js";import{u as J,B as l,T as t}from"./use-language-CHwsoj7c.js";import{f as C}from"./currency-DKMrUsgB.js";import{C as K}from"./Container-BRr39q6J.js";import{R as Q,C as E}from"./Row-B5u1sdwU.js";import{T as d,F as j,S as v}from"./TextField-Bb3uU5kP.js";import{I as X}from"./InputAdornment-CgHuUrpB.js";/* empty css            */import"./Menu-Cs8Ccy14.js";import"./Close-CYqzBEWt.js";import"./Message-Cnuldpbo.js";import"./Snackbar-HLkvRKYd.js";import"./LocationOn-D_bTv6FM.js";import"./Star-79-HC50A.js";import"./CheckCircle-D36UaMMM.js";const Y=R(e.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"})),Z="/images/popular-stay-1.svg";function je(){const{t:r}=J(),{currency:k}=A(),{property:i,nights:_,checkin:h,checkout:g,costs:I,totalAmount:S,rules:P}=M().props,D=(s,n)=>{const m={};i?.id&&(m.property_id=String(i.id)),m.checkin=s,m.checkout=n;const u=`/booking?${new URLSearchParams(m).toString()}`;W.visit(u,{method:"get",preserveState:!0,only:["costs","totalAmount","nights","checkin","checkout"]})},[a,w]=p.useState({name:"",email:"",phone:"",phoneCode:"+31",guests:1,rooms:1,adults:1,children:0,paymentMethod:"ideal",cardNumber:"",expiryDate:"",csv:""});p.useEffect(()=>{i&&w(s=>({...s,rooms:Math.max(1,i.bedrooms||1),guests:Math.max(1,i.guests||1),adults:Math.max(1,i.guests?Math.min(i.guests,10):1),children:0}))},[i]);const[o,y]=p.useState({}),[b,N]=p.useState({open:!1,message:"",severity:"success"}),L=()=>{const s={};return a.name.trim()?a.name.trim().length<2&&(s.name=r("booking.err_name_min")):s.name=r("booking.err_name_required"),a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)||(s.email=r("booking.err_email_invalid")):s.email=r("booking.err_email_required"),a.phone.trim()?/^\d{7,15}$/.test(a.phone.replace(/[\s\-\(\)]/g,""))||(s.phone=r("booking.err_phone_invalid")):s.phone=r("booking.err_phone_required"),a.cardNumber.trim()?/^\d{13,19}$/.test(a.cardNumber.replace(/\s|-/g,""))||(s.cardNumber=r("booking.err_card_invalid")):s.cardNumber=r("booking.err_card_required"),a.expiryDate.trim()?/^(0[1-9]|1[0-2])\/\d{2,4}$/.test(a.expiryDate)||(s.expiryDate=r("booking.err_expiry_invalid")):s.expiryDate=r("booking.err_expiry_required"),a.csv.trim()?/^\d{3,4}$/.test(a.csv)||(s.csv=r("booking.err_csv_invalid")):s.csv=r("booking.err_csv_required"),y(s),Object.keys(s).length===0},c=(s,n)=>{w({...a,[s]:n}),o[s]&&y({...o,[s]:""})},[z,F]=p.useState(!1),q=s=>{if(s.preventDefault(),!L()){N({open:!0,message:r("booking.toast_fix_errors"),severity:"error"});return}if(!i?.id){N({open:!0,message:r("booking.select_property"),severity:"error"});return}const n=a.cardNumber.replace(/\s|-/g,""),m=n.length>=4?n.slice(-4):"";F(!0),W.post("/booking",{property_id:i.id,checkin:h,checkout:g,name:a.name.trim(),email:a.email.trim(),phone_code:a.phoneCode||"+31",phone:a.phone.trim(),rooms:a.rooms??1,adults:a.adults??1,children:a.children??0,card_last_four:m,payment_method:a.paymentMethod==="ideal"?"ideal":"credit_card"},{onFinish:()=>F(!1),onError:u=>y(u)})};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:r("booking.title")}),e.jsxs(l,{children:[e.jsx(G,{}),e.jsx(l,{className:"booking-page",children:e.jsxs(K,{className:"px-0",children:[e.jsx(l,{sx:{mb:2,mt:4},children:e.jsx(t,{variant:"h2",sx:{fontSize:"2.5rem",fontWeight:800,color:"#222222",mb:2},children:r("booking.title")})}),e.jsxs(Q,{children:[e.jsx(E,{xs:12,md:7,lg:8,className:"px-0",children:e.jsxs(T,{elevation:0,className:"booking-form",children:[e.jsx(t,{className:"section-title",sx:{fontSize:"1.5rem",fontWeight:700,color:"#222222",mb:2},children:r("booking.guest_details")}),e.jsxs("form",{onSubmit:q,children:[i&&e.jsxs(x,{direction:"row",spacing:1.5,useFlexGap:!0,className:"field",sx:{mb:2},children:[e.jsxs(l,{sx:{flex:1},children:[e.jsx(t,{className:"label",children:r("home.checkin")}),e.jsx(d,{size:"small",fullWidth:!0,type:"date",value:h,onChange:s=>{const n=s.target.value;let m=g;if(new Date(n)>=new Date(g)){const u=new Date(n);u.setDate(u.getDate()+1),m=u.toISOString().slice(0,10)}D(n,m)},InputLabelProps:{shrink:!0},inputProps:{min:new Date().toISOString().slice(0,10)}})]}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(t,{className:"label",children:r("home.checkout")}),e.jsx(d,{size:"small",fullWidth:!0,type:"date",value:g,onChange:s=>{const n=s.target.value;new Date(n)<=new Date(h)||D(h,n)},InputLabelProps:{shrink:!0},inputProps:{min:h}})]})]}),i&&e.jsx(t,{variant:"body2",sx:{color:"#6B7280",mb:2},children:_!==1?r("booking.nights_note_plural").replace(":count",String(_)):r("booking.nights_note").replace(":count",String(_))}),e.jsxs(l,{className:"field",children:[e.jsx(t,{className:"label",children:r("booking.name")}),e.jsx(d,{size:"small",fullWidth:!0,value:a.name,onChange:s=>c("name",s.target.value),required:!0,error:!!o.name,helperText:o.name})]}),e.jsxs(l,{className:"field",children:[e.jsx(t,{className:"label",children:r("booking.number_of_rooms")}),e.jsx(j,{fullWidth:!0,size:"small",children:e.jsx(v,{value:a.rooms,displayEmpty:!0,onChange:s=>c("rooms",Number(s.target.value)),children:[1,2,3,4,5,6,7,8,9,10].map(s=>e.jsxs(f,{value:s,children:[s," ",s>1?r("booking.rooms"):r("booking.room")]},s))})})]}),e.jsxs(x,{direction:"row",spacing:1.5,useFlexGap:!0,className:"field",children:[e.jsxs(l,{sx:{flex:1},children:[e.jsx(t,{className:"label",children:r("booking.adults")}),e.jsx(j,{fullWidth:!0,size:"small",children:e.jsx(v,{value:a.adults,displayEmpty:!0,onChange:s=>c("adults",Number(s.target.value)),children:[1,2,3,4,5,6,7,8,9,10].map(s=>e.jsxs(f,{value:s,children:[s," ",s>1?r("booking.adults"):r("booking.adult")]},s))})})]}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(t,{className:"label",children:r("booking.children")}),e.jsx(j,{fullWidth:!0,size:"small",children:e.jsx(v,{value:a.children,displayEmpty:!0,onChange:s=>c("children",Number(s.target.value)),children:[0,1,2,3,4,5,6,7,8,9,10].map(s=>e.jsxs(f,{value:s,children:[s," ",r(s===1?"booking.child":"booking.children")]},s))})})]})]}),e.jsxs(l,{className:"field",children:[e.jsx(t,{className:"label",children:r("booking.email")}),e.jsx(d,{size:"small",placeholder:r("booking.email_placeholder"),fullWidth:!0,type:"email",value:a.email,onChange:s=>c("email",s.target.value),required:!0,error:!!o.email,helperText:o.email})]}),e.jsxs(l,{className:"field",children:[e.jsx(t,{className:"label",children:r("booking.phone_number")}),e.jsxs(x,{direction:"row",spacing:1.5,useFlexGap:!0,children:[e.jsx(j,{size:"small",sx:{minWidth:120},children:e.jsx(v,{value:a.phoneCode,onChange:s=>c("phoneCode",s.target.value),children:["+31","+44","+1","+92"].map(s=>e.jsx(f,{value:s,children:s},s))})}),e.jsx(d,{size:"small",fullWidth:!0,value:a.phone,onChange:s=>c("phone",s.target.value),error:!!o.phone,helperText:o.phone})]}),e.jsx(t,{className:"help",children:r("booking.phone_note")})]}),e.jsx(t,{className:"section-title",sx:{fontSize:"1.5rem",fontWeight:700,color:"#222222",mb:2,mt:1.5},children:r("booking.card_info")}),e.jsxs(l,{className:"field",children:[e.jsx(t,{className:"label",children:r("booking.card_number")}),e.jsx(d,{size:"small",fullWidth:!0,value:a.cardNumber,onChange:s=>c("cardNumber",s.target.value),InputProps:{startAdornment:e.jsx(X,{position:"start",children:e.jsx(Y,{sx:{color:"#9CA3AF"}})})},error:!!o.cardNumber,helperText:o.cardNumber})]}),e.jsxs(x,{direction:"row",spacing:1.5,useFlexGap:!0,className:"field",children:[e.jsxs(l,{sx:{flex:1},children:[e.jsx(t,{className:"label",children:r("booking.expiry_date")}),e.jsx(d,{size:"small",fullWidth:!0,placeholder:r("booking.expiry_placeholder"),value:a.expiryDate,onChange:s=>c("expiryDate",s.target.value),error:!!o.expiryDate,helperText:o.expiryDate})]}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(t,{className:"label",children:r("booking.csv")}),e.jsx(d,{size:"small",fullWidth:!0,placeholder:r("booking.csv_placeholder"),value:a.csv,onChange:s=>c("csv",s.target.value),error:!!o.csv,helperText:o.csv})]})]}),e.jsxs(T,{elevation:0,className:"booking-total",children:[e.jsx(t,{children:r("booking.total")}),e.jsxs(x,{direction:"row",spacing:2,useFlexGap:!0,alignItems:"center",children:[e.jsx(t,{className:"grand-total",children:C(S,k)}),e.jsx(O,{type:"submit",variant:"contained",className:"request-btn",disabled:z,children:z?"...":r("booking.book_btn")})]})]})]})]})}),e.jsxs(E,{xs:12,md:5,lg:4,children:[e.jsx(V,{image:i?.image??Z,title:i?.title??r("booking.select_property"),location:i?.location??"â€”",reviews:i?.reviews_count??0,rating:i?.rating??0}),e.jsx(U,{rules:P,costs:I.map(s=>({label:s.label,amount:C(s.amount,k)})),totalAmount:C(S,k)})]})]})]})}),e.jsx(H,{}),e.jsx($,{open:b.open,onClose:()=>N({...b,open:!1}),message:b.message,severity:b.severity})]})]})}export{je as default};
